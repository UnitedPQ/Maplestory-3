// Generated by CoffeeScript 1.8.0

var winwidth = 0;
var winheight = 0;
var imgComplete = 0;
var totalimg = 15;

$(document).ready(function() {
	var zIndex;
	winwidth = $(window).width();
	winheight = $(window).height();
	var rem = winwidth / 32;
	rem = rem.toFixed(1);
	$("html").css("font-size",rem+"px");
	$("body,.container").width(winwidth).height(winheight);
	
	if( $('.index-bottom img').size() > 0 ){
		$('.index-bottom img,.clearfix img').each(function() {
			var img = this;
			if(img.complete){
				imgComplete ++;
				console.log(imgComplete);
				if(imgComplete >= totalimg){
					pageLoading("hide");
					$(".box-bg,.icon1,.icon2,.icon3,.icon4,.icon5,.icon6,.icon7,.he,.title1,.title2,.title3,.text,nav,.startbg,.starttxt").addClass("run");
				}
			}
		  
			img.onload = function () { 
				imgComplete ++;
				console.log(imgComplete);
				if(imgComplete >= totalimg){
					pageLoading("hide");
					$(".box-bg,.icon1,.icon2,.icon3,.icon4,.icon5,.icon6,.icon7,.he,.title1,.title2,.title3,.text,nav,.startbg,.starttxt").addClass("run");
				}
			}
		});
	}else{
		pageLoading("hide");
	}
	
})



//---页面等待---//
function pageLoading(sw){
	if (sw == "show"){
		$(".fullmask,.pageloading").show();
	}
	if (sw == "hide"){
		$(".fullmask,.pageloading").hide();
	}
}

$.alert = function(message, button, title) {
  var d;
  //return alert(message);
  if (button == null) {
    button = [];
  }
  if (title == null) {
    title = '小V温馨提示...';
  }
  d = dialog({
    width: 380,
    title: title,
    content: message,
    okValue: '关闭',
    ok: function() {},
    button: button
  });
  //return d.showModal();
};

var dialog = function(config){
	console.log(config);
	var fullcover = $("<div />",
        {
	        id:"fullcover",
	        css:{
	        	'opacity': '0.7',
	        	'position': 'fixed', 
	        	'left': '0px', 
	        	'top': '0px', 
	        	'width': '100%', 
	        	'height': '100%', 
	        	'overflow': 'hidden',
	        	'z-index':'9999',
	        	'background-color': '#000000',
	        	},
	    });
	
	
	var dialoggrid = $("<div />",
	    {
	        id:"dialog-grid",
	        css:{
	        	'z-index':'10000',
	        	'width': '28rem', 
	        	'height': 'auto', 
	        	'position': 'fixed',
	        	'left':'2rem',
	        	'top': '0px', 
	        	'border-radius':'1rem',
	        	'background-color': '#00dbff',
	        	'overflow':'hidden',
	        	'-webkit-box-shadow':'0 0 8px rgba(0, 0, 0, 0.1), 0 0 256px rgba(255, 255, 255, .3)',
	        	'opacity':'0',
	        	},
	    });
	var dialogtop = $("<div />",
		    {	
				text:config.title,
		        id:"dialog-top",
		        css:{
		        	'width': 'auto', 
		        	'padding':'1rem',
		        	'border-bottom':'0.1rem solid #00b2f0',
		        	'color': '#8100e8',
		        	'font-size':'1.5rem',
		        	},
		    });
	var dialogcontent = $("<div />",
		    {	
				text:config.content,
		        id:"dialog-content",
		        css:{
		        	'width': 'auto', 
		        	'padding':'1.3rem',
		        	'color': '#7537eb',
		        	'font-size':'1.6rem',
		        	'max-height': '20rem',
			        'overflow-y': 'auto',
			        'overflow-x': 'hidden',
		        	},
		    });
	var dialogbottom = $("<div />",
		    {	
		        id:"dialog-bottom",
		        css:{
		        	'width': '25rem',
		        	'height': '3rem',
		        	'padding':'0 1.5rem 1.5rem',
		        	'margin':'0 auto 1.5rem',
		        	'border-radius':'0.5rem',
		        	'color': '#fff',
					'line-height':'3rem',
					'text-align':'center',
					'font-size':'1.5rem',
		        	},
		    });
	var dialogclose;
	if(config.okValue){
		dialogclose = $("<div />",
		    {	
				text:config.okValue,
		        id:"dialog-close",
		        css:{
		        	'min-width': '8rem',
		        	'height': '3rem',
		        	'padding':'0.5rem',
		        	'margin-right':'1rem',
		        	'float':'right',
		        	'border-radius':'0.5rem',
		        	'border':'0.1rem solid #aaf3ff',
		        	'background-color': '#bc67ff',
		        	'color': '#fff',
					'line-height':'3rem',
					'text-align':'center',
					'font-size':'1.5rem',
		        	},
		    });
	}
	var dialogcancel;
	if(config.cancelValue){
		dialogcancel = $("<div />",
		    {	
				text:config.cancelValue,
		        id:"dialog-cancel",
		        css:{
		        	'min-width': '8rem',
		        	'height': '3rem',
		        	'padding':'0.5rem',
		        	'margin-right':'1rem',
		        	'float':'right',
		        	'border-radius':'0.5rem',
		        	'border':'0.1rem solid #aaf3ff',
		        	'background-color': '#bc67ff',
		        	'color': '#fff',
					'line-height':'3rem',
					'text-align':'center',
					'font-size':'1.5rem',
		        	},
		    });
	}
	
	var dialogbutton;
	if(config.button && config.button.length > 0){
		dialogbutton = $("<div />",
		{	
			text:config.button[0].value,
	        id:"dialog-button",
	        css:{
	        	'min-width': '8rem',
	        	'height': '3rem',
	        	'padding':'0.5rem 1rem',
	        	'margin':'0 1rem 0 0',
	        	'float':'right',
	        	'border-radius':'0.5rem',
	        	'border':'0.1rem solid #aaf3ff',
	        	'background-color': '#bc67ff',
	        	'color': '#fff',
				'line-height':'3rem',
				'text-align':'center',
				'font-size':'1.5rem',
	        	},
	    });
	}
	
	$("body").append(fullcover);
	$("body").append(dialoggrid);
	dialoggrid.append(dialogtop);
	dialoggrid.append(dialogcontent);
	dialoggrid.append(dialogbottom);
	if(dialogclose){
		dialogbottom.append(dialogclose);
	}
	if(dialogcancel){
		dialogbottom.append(dialogcancel);
	}
	if(dialogbutton){
		dialogbottom.append(dialogbutton);
	}
	
	var dwidth = dialoggrid.width();
	var dheight = dialoggrid.height();
	var dleft = winwidth > dwidth ? ( (winwidth-dwidth)/2 ):0;
	var dtop = winheight > dheight ? ( (winheight-dheight)/2 ) : 0;
	dialoggrid.css({top:dtop+"px",left:dleft+"px",'-webkit-transform':'scale(0)','opacity':'1'});
	dialoggrid.animate({
		  '-webkit-transform': "scale(1)" ,
	  },150 );
	if(config.okValue){
		$("#dialog-close").off().on("tap",function(){
			dialoggrid.remove();
			fullcover.remove();
			if(config.ok){
				config.ok();
			}
		});
	}
	if(config.cancelValue){
		$("#dialog-cancel").off().on("tap",function(){
			dialoggrid.remove();
			fullcover.remove();
			if(config.cancel){
				config.cancel();
			}
		});
	}
	if(config.button){
		$("#dialog-button").off().on("tap",function(){
			dialoggrid.remove();
			fullcover.remove();
			if(config.button[0].callback){
				config.button[0].callback();
			}
		});
	}
}

